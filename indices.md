# Indices

This file maintains a list of the xclim/icclim/climpact indices required for model evaluation.

#### List of indicators for each package
- xclim indices: https://xclim.readthedocs.io/en/stable/indicators.html
- icclim indices: https://icclim.readthedocs.io/en/stable/explanation/climate_indices.html#icclim-capabilities
- climpact indices: https://github.com/ARCCSS-extremes/climpact/blob/master/www/user_guide/Climpact_user_guide.md#appendixa

(Note: view raw to see markdown table formatting.)

### Temperature indices
| Index (Climpact short name) | Climpact long name | Description | xclim | icclim | Climpact | Hazard | Equation | Notes |
| - | - | - | - | - | - | - | - | - |
| txn | Min TX | Coldest daily maximum temperature | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $TXn$ be the daily maximum temperatures in month $k$, period $j$. The minimum daily maximum temperature each month is then $TXn_{kj} = min(TXn_{kj})$ | - |
| txx | Max TX | Warmest daily maximum temperature | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heatwaves, bushfires, extreme temperature | Let $TXx$ be the daily maximum temperatures in month $k$, period $j$. The maximum daily maximum temperature each month is then $TXx_{kj} = max(TXx_{kj})$. | - |
| txm | Mean TX | Mean daily maximum temperature | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | - | Defined as ```tx``` in icclim |
| tx10p | Amount of cool days | Percentage of days when daily maximum temperature is less than 10th percentile | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $TX_{ij}$ be the daily maximum temperature on day $i$ in period $j$ and let $TX_{in}10$ be the calendar day 10th percentile centred on a 5-day window for the base period 1961-1990. The percentage of time for the base period is determined where $TX{ij} < TX_{in}10$. To avoid possible inhomogeneity across the in-base and out-base periods, the calculation for the base period (1961-1990) requires the use of a bootstrap processure. Details are described in [Zhang et al. (2005)](https://doi.org/10.1175/JCLI3366.1). | xclim doesn't calculate percentiles, percentile needs to be pre-calculated as a DataArray and fed into function. <br>xclim defines ```tx10p``` as number of days, climpact defines it as percentage, need to check icclim output |
| tx90p | Amount of hot days | Percentage of days when daily maximum temperature is greater than 90th percentile | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heatwaves, bushfires, extreme temperature | Let $TX_{ij}$ be the daily maximum temperature on day $i$ in period $j$ and let $TX_{in}90$ be the calendar day 90th percentile centred on a 5-day window for the base period 1961-1990. The percentage of time for the base period is determined where $TX_{ij} > TX_{in}90$. To avoid possible inhomogeneity across the in-base and out-base periods, the calculation for the base period (1961-1990) requires the use of a bootstrap processure. Details are described in [Zhang et al. (2005)](https://doi.org/10.1175/JCLI3366.1). | xclim doesn't calculate percentiles, percentile needs to be pre-calculated as a DataArray and fed into function. <br>xclim defines ```tx90p``` as number of days, climpact defines it as percentage, need to check icclim output |
| tnn | Min TN | Coldest daily minimum temperature | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $TNn$ be the daily minimum temperatures in month $k$, period $j$. The minimum daily minimum temperature each month is then $TNn_{kj}=min(TNn_{kj})$ | - |
| tnx | Max TN | Warmest daily minimum temperature | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $TNx$ be the daily minimum temperatures in month $k$, period $j$. The maximum daily minimum temperature each month is then $TNx_{kj} = max(TNx_{kj})$. | - |
| tnm | Mean TN | Mean daily minimum temperature | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | - | Defined as ```tn``` in icclim |
| tn10p | Amount of cold nights | Percentage of days when daily minimum temperature is less than 10th percentile | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $TN_{ij}$ be the daily minimum temperature on day $i$ in period $j$ and let $TN_{in}10$ be the calendar day 10th percentile centred on a 5-day window for the base period 1961-1990. The percentage of time for the base period is determined where: $TN_{ij} < TN_{in}10$. To avoid possible inhomogeneity across the in-base and out-base periods, the calculation for the base period (1961-1990) requires the use of a bootstrap procedure. Details are described in [Zhang et al. (2005)](https://doi.org/10.1175/JCLI3366.1). | xclim doesn't calculate percentiles, percentile needs to be pre-calculated as a DataArray and fed into function. <br>xclim defines ```tn10p``` as number of days, climpact defines it as percentage, need to check icclim output |
| tn90p | Amount of warm nights | Percentage of days when daily minimum temperature is greater than 90th percentile | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $TN_{ij}$ be the daily minimum temperature on day $i$ in period $j$ and let $TN_{in}90$ be the calendar day 90th percentile centred on a 5-day window for the base period 1961-1990. The percentage of time for the base period is determined where $TN_{ij} > TN_{in}90$. To avoid possible inhomogeneity across the in-base and out-base periods, the calculation for the base period (1961-1990) requires the use of a bootstrap processure. Details are described in [Zhang et al. (2005)](https://doi.org/10.1175/JCLI3366.1) | xclim doesn't calculate percentiles, percentile needs to be pre-calculated as a DataArray and fed into function. <br>xclim defines ```tn90p``` as number of days, climpact defines it as percentage, need to check icclim output |
| tmm | Mean TM | Mean daily mean temperature | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | - | Defined as ```tg``` in icclim |
| dtr | Daily Temperature Range | Mean difference between daily TX and daily TN | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $TX_{ij}$ and $TN_{ij}$ be the daily maximum and minimum temperature respectively on day $i$ in period $j$. If $I$ represents the number of days in $j$, then: $$DTR_j={\sum^I_{i=1} (TX_{ij}-TN_{ij}) \over I}$$ | - |
| hwn | Heatwave number (HWN) as defined by either the Excess Heat Factor (EHF), 90th percentile of TX or the 90th percentile of TN | The number of individual heatwaves that occur each summer (Nov – Mar in southern hemisphere and May – Sep in northern hemisphere). A heatwave is defined as 3 or more days where either the EHF is positive, TX > 90th percentile of TX or where TN > 90th percentile of TN. Where percentiles are calculated from base period specified by user. | :heavy_check_mark: | - | :heavy_check_mark: | Heatwaves | - | Defined as ```heat wave frequency``` in xclim. xclim uses absolute values, climpact uses 90th percentile or excess heat factor. See [Perkins & Alexander (2013)](http://dx.doi.org/10.1175/JCLI-D-12-00383.1) |
| hwf | Heatwave frequency (HWF) as defined by either the Excess Heat Factor (EHF), 90th percentile of TX or the 90th percentile of TN | The number of days that contribute to heatwaves as identified by HWN. | - | - | :heavy_check_mark: | Heatwaves | - | See [Perkins & Alexander (2013)](http://dx.doi.org/10.1175/JCLI-D-12-00383.1) |
| hwd | Heatwave duration (HWD) as defined by either the Excess Heat Factor (EHF), 90th percentile of TX or the 90th percentile of TN | The length of the longest heatwave identified by HWN. | :heavy_check_mark: | - | :heavy_check_mark: | Heatwaves | - | Defined as ```heat wave max length``` in xclim. See [Perkins & Alexander (2013)](http://dx.doi.org/10.1175/JCLI-D-12-00383.1) |
| hwm | Heatwave magnitude (HWM) as defined by either the Excess Heat Factor (EHF), 90th percentile of TX or the 90th percentile of TN | The mean temperature of all heatwaves identified by HWN. | - | - | :heavy_check_mark: | Heatwaves | - | See [Perkins & Alexander (2013)](http://dx.doi.org/10.1175/JCLI-D-12-00383.1) |
| hwa | Heatwave amplitude (HWA) as defined by either the Excess Heat Factor (EHF), 90th percentile of TX or the 90th percentile of TN | The peak daily value in the hottest heatwave (defined as the heatwave with highest HWM). | - | - | :heavy_check_mark: | Heatwaves | - | See [Perkins & Alexander (2013)](http://dx.doi.org/10.1175/JCLI-D-12-00383.1) |


### Rainfall indices
| Index (Climpact short name) | Climpact long name | Description | xclim | icclim | Climpact | Hazard | Equation | Notes |
| - | - | - | - | - | - | - | - | - |
| rx1day | Max 1-day PR | Maximum 1 day precipitation | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heavy rainfall, floods | Let $RR_{ij}$ be the daily precipitation amount on day $i$ in period $j$. The maximum 1-day value for period $j$ are $Rx1day_j = max(RR_{ij})$ | - |
| rx5day | Max 5-day PR | Maximum 5 day precipitation | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heavy rainfall, floods | Let $RR_{kj}$ be the precipitation amount for the 5-day interval ending $k$, period $j$. Then maximum 5-day values for period $j$ are $Rx5day_j = max(RR_{kj})$ | Some differences between xclim & climpact due to centering of 5-day period. By definition the window should be on the last day, need to use ```fclimdex.compatible=TRUE``` in ```climpact.ncdf.wrapper.r``` to get the same result in climpact as xclim. See also: [CRAN RX5day](https://search.r-project.org/CRAN/refmans/climdex.pcic/html/climdex.rx5day.html) |
| r10mm | Number of heavy rain days | Number of days when rainfall is greater than or equal to 10mm | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heavy rainfall, floods | Let $RR_{ij}$ be the daily precipitation amount on day $i$ in period $j$. Count the number of days where $RR_{ij} ≥ 10mm$ | - |
| r20mm | Number of very heavy rain days | Number of days when rainfall is greater than or equal to 20mm | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heavy rainfall, floods | Let $RR_{ij}$ be the daily precipitation amount on day $i$ in period $j$. Count the number of days where $RR_{ij} ≥ 20mm$ | - |
| r95p | Total annual PR from heavy rain days | Amount of rainfall from very wet days  | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heavy rainfall, floods | Let $RR_{wj}$ be the daily precipitation amount on a wet day $w (RR ≥ 1.0mm)$ in period $i$ and let $RR_{wn}95$ be the 95th percentile of precipitation on wet days in the 1961-1990 period. If $W$ represents the number of wet days in the period, then: $$R95p=\sum^W_{w=1}RR_{wj}$$ where $$RR_{wj}>RR_{wn}95$$ | xclim doesn't calculate percentiles, percentile needs to be pre-calculated as a DataArray and fed into function |
| r99p | Total annual PR from very heavy rain days | Amount of rainfall from extremely wet days  | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heavy rainfall, floods  | Let $RR_{wj}$ be the daily precipitation amount on a wet day $w (RR ≥ 1.0mm)$ in period $i$ and let $RR_{wn}99$ be the 99th percentile of precipitation on wet days in the 1961-1990 period. If $W$ represents the number of wet days in the period, then: $$R99p=\sum^W_{w=1}RR_{wj}$$ where $$RR_{wj}>RR_{wn}99$$ | As above |
| r95ptot | Contribution from very wet days | Fraction of total wet-day rainfall that comes from very wet days | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heavy rainfall, floods | $$R95pTOT=100 \times R95p \over PRCPTOT$$ | As above |
| r99ptot | Contribution from extremely wet days | Fraction of total wet-day rainfall that comes from extremely wet days | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Heavy rainfall, floods | $$R99pTOT=100 \times R99p \over PRCPTOT$$ | As above |
| prcptot | Total wet-day PR | Total precipitation | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $RR_{ij}$ be the daily precipitation amount on day $i$ in period $j$, then: $$PRCPTOT_j=\sum^I_{i=1}RR_{ij}$$ | - |
| cdd | Consecutive Dry Days | Maximum number of consecutive dry days (when PR < 1.0 mm) | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Drought | Let $RR_{ij}$ be the daily precipitation amount on day $i$ in period $j$. Count the largest number of consecutive days where $RR_{ij} < 1mm$ | - |
| cwd | Consecutive Wet Days | Maximum annual number of consecutive wet days (when PR >= 1.0 mm) | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | Floods | Let $RR_{ij}$ be the daily precipitation amount on day $i$ in period $j$. Count the largest number of consecutive days where $RR_{ij} ≥ 1mm$ | - |
| sdii | Daily PR intensity | Average daily wet-day rainfall intensity | :heavy_check_mark: | :heavy_check_mark: | :heavy_check_mark: | - | Let $RR_{wj}$ be the daily precipitation amount on wet days, $w (RR ≥ 1mm)$ in period $j$. If $W$ represents number of wet days in $j$, then: $$SDII_j=\sum^W_{w=1}RR_{wj} \over W$$ | - |


### Compound indices
| Index | Description | xclim | icclim | Climpact | Hazard | Notes |
| - | - | - | - | - | - | - |
| cd | Cold and dry days | :heavy_check_mark: | :heavy_check_mark: | - | - | Days with ```tg```\\```tmm``` < 25th percentile of daily mean temperature and ```rr``` <25th percentile of daily precipitation sum (cold/dry days) |
| cw | Cold and wet days | :heavy_check_mark: | :heavy_check_mark: | - | - | Days with ```tg```\\```tmm``` < 25th percentile of daily mean temperature and ```rr``` >75th percentile of daily precipitation sum (cold/wet days) |
| wd | Warm and dry days | :heavy_check_mark: | :heavy_check_mark: | - | - | Days with ```tg```\\```tmm``` > 75th percentile of daily mean temperature and ```rr``` <25th percentile of daily precipitation sum (warm/dry days) |
| ww | Warm and wet days | :heavy_check_mark: | :heavy_check_mark: | - | - | Days with ```tg```\\```tmm``` > 75th percentile of daily mean temperature and ```rr``` >75th percentile of daily precipitation sum (warm/wet days) |

... and so on.

#### [Pros/Cons of each package](https://github.com/AusClimateService/ccam-evaluation/blob/main/xclim_icclim_climpact_pro_cons.md)
---
### References
Below are some references for xclim, icclim, and climpact indices. Please see the [three indices lists](#list-of-indicators-for-each-package) above for specific index references

#### xclim
- European Climate Assessment & Dataset, https://www.ecad.eu/
- https://www.ecad.eu/documents/atbd.pdf

#### icclim
- https://icclim.readthedocs.io/en/stable/references/index.html

#### Climpact
- McKee T B, Doesken N J and Kleist J 1993 The relationship of drought frequency and duration to time scales Proceedings of the 8th Conference on Applied Climatology vol 17 (American Meteorological Society Boston, MA, USA) pp 179–83
- Nairn J R and Fawcett R G 2013 Defining heatwaves: heatwave defined as a heat-impact event servicing all community and business sectors in Australia (Centre for Australian Weather and Climate Research) Online: http://www.cawcr.gov.au/technical-reports/CTR_060.pdf
- Perkins S E and Alexander L V 2013 On the Measurement of heatwaves J. Clim. 26 4500–17 Online: http://dx.doi.org/10.1175/JCLI-D-12-00383.1
- Vicente-Serrano S M, Beguería S and López-Moreno J I 2010 A Multiscalar Drought Index Sensitive to Global Warming: The Standardized Precipitation Evapotranspiration Index J. Clim. 23 1696–718 Online: http://dx.doi.org/10.1175/2009JCLI2909.1
- WMO 2012 Standardized Precipitation Index User Guide (7 bis, avenue de la Paix – P.O. Box 2300 – CH 1211 Geneva 2 – Switzerland) Online: http://www.wamis.org/agm/pubs/SPI/WMO_1090_EN.pdf
- Zhang X, Alexander L, Hegerl G C, Jones P, Tank A K, Peterson T C, Trewin B and Zwiers F W 2011 Indices for monitoring changes in extremes based on daily temperature and precipitation data Wiley Interdiscip. Rev. Clim. Chang. 2 851–70 Online: https://onlinelibrary.wiley.com/doi/full/10.1002/wcc.147
